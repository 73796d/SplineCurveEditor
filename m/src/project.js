window.__require=function t(e,i,o){function n(c,a){if(!i[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var p="function"==typeof __require&&__require;if(!a&&p)return p(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}}var h=i[c]={exports:{}};e[c][0].call(h.exports,function(t){return n(e[c][1][t]||t)},h,h.exports,t,e,i,o)}return i[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<o.length;c++)n(o[c]);return n}({NewScript:[function(t,e,i){"use strict";cc._RF.push(e,"45768zMRhlGzonGxOL23h9R","NewScript");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./basedraw"),c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.start=function(){this.clearDraw(),this.drawRectPoint(cc.Vec2.ZERO,cc.Color.GREEN,10,10,!0),this.node.width=20,this.node.height=20},e.prototype.update=function(){this.clearDraw(),this.drawRectPoint(cc.Vec2.ZERO,cc.Color.GREEN,10,10,!0)},e=n([a],e)}(r.default));i.default=s,cc._RF.pop()},{"./basedraw":"basedraw"}],basedraw:[function(t,e,i){"use strict";cc._RF.push(e,"fb9f0HG4sFJjLw+g5a1GbkP","basedraw");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"graphics",{get:function(){return this.graphics_},set:function(t){this.graphics_=t},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.graphics?this.graphics=this.getComponent(cc.Graphics):this.graphics=this.addComponent(cc.Graphics)},e.prototype.setLineCap=function(t){this.graphics.lineCap=t},e.prototype.setLineJoin=function(t){this.graphics.lineJoin=t},e.prototype.setLineWidth=function(t){this.graphics.lineWidth=t},e.prototype.setStrokeColor=function(t){this.graphics.strokeColor=t},e.prototype.setFillColor=function(t){this.graphics.fillColor=t},e.prototype.drawCirclePoint=function(t,e,i,o){this.setStrokeColor(e),this.graphics.circle(t.x,t.y,i),this.graphics.stroke(),o&&(this.setFillColor(e),this.graphics.fill())},e.prototype.drawRectPoint=function(t,e,i,o,n){this.setStrokeColor(e),this.graphics.rect(t.x,t.y,i,o),this.graphics.stroke(),n&&(this.setFillColor(e),this.graphics.fill())},e.prototype.drawLine=function(t,e,i,o){this.setLineWidth(o),this.setStrokeColor(i),this.setLineCap(cc.Graphics.LineCap.BUTT),this.graphics.moveTo(t.x,t.y),this.graphics.lineTo(e.x,e.y),this.graphics.stroke()},e.prototype.drawBezierCurve=function(t,e,i,o){this.graphics.moveTo(t.x,t.y),this.graphics.bezierCurveTo(e.x,e.y,i.x,i.y,o.x,o.y),this.graphics.stroke()},e.prototype.clearDraw=function(){this.graphics.clear()},e=n([c],e)}(cc.Component));i.default=a,cc._RF.pop()},{}],beziernode:[function(t,e,i){"use strict";cc._RF.push(e,"47b6bQ1kiNEIZYv4hQr6tFK","beziernode"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./cubicbezier"),n=function(){function t(t,e,i,n){this.index_=0,this.p0=null,this.p1=null,this.p2=null,this.p3=null,this.p0p=cc.Vec2.ZERO,this.p1p=cc.Vec2.ZERO,this.p2p=cc.Vec2.ZERO,this.p3p=cc.Vec2.ZERO,this.cubicBezier=null,this.p0=t,this.p1=e,this.p2=i,this.p3=n,this.cubicBezier=new o.default}return Object.defineProperty(t.prototype,"index",{get:function(){return this.index_},set:function(t){this.index_=t},enumerable:!0,configurable:!0}),t.prototype.updatePosition=function(t){this.p0p=this.p0.position,this.p1p=this.p1.position,this.p2p=this.p2.position,this.p3p=this.p3.position,this.cubicBezier.p0=this.p0p,this.cubicBezier.p1=this.p1p,this.cubicBezier.p2=this.p2p,this.cubicBezier.p3=this.p3p},t.prototype.getLength=function(t){return this.cubicBezier.length(t)},t}();i.default=n,cc._RF.pop()},{"./cubicbezier":"cubicbezier"}],binpackbuilder:[function(t,e,i){"use strict";cc._RF.push(e,"c93cbPwQMxKQasLB4JPbJfW","binpackbuilder"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./fontbinpacker"),n=function(){function t(){this.atlasWidth=0,this.atlasHeight=0,this.sourceRects=null,this.packedRects=null}return t.prototype.init=function(t,e,i){this.atlasWidth=t,this.atlasHeight=e,this.sourceRects=i},t.prototype.build=function(){var t=this.findBestBinPacker(this.atlasWidth,this.atlasHeight,this.sourceRects);return null!==t&&(this.packedRects=t,!0)},t.prototype.findBestBinPacker=function(t,e,i){for(var n=new Array,r=new Array,c=[o.BestShortSideFit,o.BestLongSideFit,o.BestAreaFit,o.BottomLeftRule,o.ContactPointRule],a=0;a<c.length;a++){for(var s=t,p=e,h=JSON.parse(JSON.stringify(i)),l=new o.FontBinPacker(s,p),u=l.insert2(h,c[a]);!l.isBinPackSuccess();)s>p?p*=2:s*=2,h=JSON.parse(JSON.stringify(i)),u=(l=new o.FontBinPacker(s,s)).insert2(h,c[a]);r.push(u),n.push(l)}var f=-1;for(a=0;a<n.length;a++){n[a].wastedBinArea()<1/0&&(f=a)}return-1==f?null:(this.atlasWidth=n[f].binWidth,this.atlasHeight=n[f].binHeight,r[f])},t}();i.default=n,cc._RF.pop()},{"./fontbinpacker":"fontbinpacker"}],bmfontui:[function(t,e,i){"use strict";cc._RF.push(e,"a78ae5+h2FLkorU2abR++wu","bmfontui");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./itemmgr"),c=t("./item"),a=t("./fontutil"),s=t("./rect"),p=t("../global"),h=cc._decorator,l=h.ccclass,u=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.input=null,e.zone=null,e.fontScrollView=null,e.imageScrollView=null,e.itemMgr=null,e.itemList=new Array,e.fileName="default",e.packItemList=null,e}return o(e,t),e.prototype.onLoad=function(){var t=this;this.itemMgr=cc.find("Canvas/ItemMgr").getComponent(r.default),this.createDragZone(),p.default.eventListener.on("REMOVE_ITEM",function(e){var i=t.deleteItem(e);t.itemMgr.deleteItem(i.node);for(var o=0;o<t.itemList.length;o++){var n=t.itemList[o],r=n.id;n.node.getChildByName("id").getComponent(cc.Label).string=r.toString()}}),p.default.eventListener.on("CHANGE_CHAR",function(e,i){t.getItemDataById(e).char=i})},e.prototype.isCanUse=function(){var t=!1;return cc.sys.isBrowser&&window.File&&window.FileReader&&window.FileList&&window.Blob&&(t=!0),t},e.prototype.createFileLoader=function(){var t=this;if(this.isCanUse()){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.setAttribute("style","\n    position:absolute;\n    margin-left:0%;\n    margin-top:0px;\n    -webkit-user-select:file;\n    display:none;"),document.getElementsByTagName("body")[0].appendChild(e),e.addEventListener("change",function(e){var i=e.target.files[0];i.type.match("image.*")&&t.readFile(i)}),this.input=e}else alert("\u4e0d\u652f\u6301")},e.prototype.createDragZone=function(){var t=this;if(this.isCanUse()){document.ondragover=function(t){t.preventDefault()},document.ondrag=function(t){t.preventDefault()};var e=document.createElement("div");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.setAttribute("style","\n    position:absolute;\n    margin-left:0px;\n    margin-top:0px;\n    border:1px solid #aaa;\n    width:100px;\n    height:100px;\n    -webkit-user-select:file;"),e.addEventListener("dragover",function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},!1),e.addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault();for(var i=e.dataTransfer.files,o=0;o<i.length;o++){var n=i[o];if(!n.type.match("image.*"))return;t.readFile(n)}},!1),document.getElementsByTagName("body")[0].appendChild(e),this.zone=e}else alert("\u4e0d\u652f\u6301")},e.prototype.readFile=function(t){var e=this;if(!this.hasItemByName(t.name)){var i=new FileReader;i.readAsDataURL(t),i.onload=function(i){var o=document.createElement("img");o.src=i.target.result;var n=new cc.Texture2D;n._nativeAsset=o,n.loaded?(e.createItem(n,t.name,t.size),e.addFontScrollItem(n)):n.on("load",function(){e.createItem(n,t.name,t.size),e.addFontScrollItem(n)})}}},e.prototype.onFileLoader=function(){this.input&&document.getElementsByTagName("body")[0].removeChild(this.input),this.createFileLoader(),this.input&&this.input.click()},e.prototype.onFileNameDidEnd=function(t){var e=t.string;""===e&&(e=t.placeholder),this.fileName=e},e.prototype.createItem=function(t,e,i){var o=this.itemList.length+1,n=new c.default;n.id=o,n.img=t,n.imgPath=e,n.char=n.imgPath.charAt(0),n.imgSize.width=t.width,n.imgSize.height=t.height,n.imgSize.id=o,n.size=i,this.itemList.push(n)},e.prototype.deleteItem=function(t){var e=this.getItemDataById(t),i=this.itemList.indexOf(e);this.itemList.splice(i,1);for(var o=0;o<this.itemList.length;o++){this.itemList[o].id=o+1}return e},e.prototype.modifyItem=function(){},e.prototype.searchItem=function(){},e.prototype.onGenerateImage=function(){for(var t=new Array,e=0;e<this.itemList.length;e++){var i=this.itemList[e];t.push(new s.Rect(i.id,0,0,i.imgSize.width,i.imgSize.height))}var o=a.FontUtil.run(t);this.imageScrollView.content.removeAllChildren();var n=o.atlasWidth,r=o.atlasHeight,c=o.packedRects;this.imageScrollView.content.width=n,this.imageScrollView.content.height=r,null===this.packItemList?this.packItemList=new Array:this.packItemList.length=0;for(e=0;e<c.length;e++){var p=c[e],h=p.id,l=this.getItemDataById(h);l.imgSize.x=p.x,l.imgSize.y=p.y,this.packItemList.push(l);var u=new cc.Node,f=u.addComponent(cc.Sprite);u.parent=this.imageScrollView.content,u.anchorX=0,u.anchorY=1,u.position=cc.v2(p.x,-p.y),f.spriteFrame=new cc.SpriteFrame(l.img)}},e.prototype.onGenerateBMF=function(){if(this.packItemList){p.default.eventListener.fire("GENERATE_IMAGE",this.fileName);for(var t=10,e=10,i=0;i<this.packItemList.length;i++){var o=this.packItemList[i];o.imgSize.width>t&&(t=o.imgSize.width),o.imgSize.height>e&&(e=o.imgSize.height)}a.FontUtil.genFontFnt(this.fileName,this.packItemList,e,this.imageScrollView.content.width,this.imageScrollView.content.height,this.packItemList.length,t)}},e.prototype.onBackMain=function(){p.default.eventListener.off("REMOVE_ITEM"),p.default.eventListener.off("CHANGE_CHAR"),this.input&&document.getElementsByTagName("body")[0].removeChild(this.input),this.zone&&document.getElementsByTagName("body")[0].removeChild(this.zone),cc.director.loadScene("Menu")},e.prototype.addFontScrollItem=function(t){var e=this.itemList[this.itemList.length-1],i=this.itemMgr.createItem();e.node=i,this.fontScrollView.content.addChild(i),i.getChildByName("id").getComponent(cc.Label).string=e.id.toString(),i.getChildByName("img").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e.img),i.getChildByName("imgpath").getComponent(cc.Label).string=e.imgPath.toString(),i.getChildByName("size").getComponent(cc.Label).string=Math.floor(e.size/1024).toString(),i.getChildByName("imgsize").getComponent(cc.Label).string=e.imgSize.width+"*"+e.imgSize.height,i.getChildByName("char").getComponent(cc.EditBox).string=""+e.char},e.prototype.getItemDataById=function(t){for(var e=0;e<this.itemList.length;e++){var i=this.itemList[e];if(i.id===t)return i}},e.prototype.hasItemByName=function(t){for(var e=!1,i=0;i<this.itemList.length;i++){this.itemList[i].imgPath===t&&(e=!0)}return e},n([u(cc.ScrollView)],e.prototype,"fontScrollView",void 0),n([u(cc.ScrollView)],e.prototype,"imageScrollView",void 0),e=n([l],e)}(cc.Component);i.default=f,cc._RF.pop()},{"../global":"global","./fontutil":"fontutil","./item":"item","./itemmgr":"itemmgr","./rect":"rect"}],cubicbezier:[function(t,e,i){"use strict";cc._RF.push(e,"8536cI4I+JNw6DtbatD2KoA","cubicbezier"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e,i,o){this.p0_=cc.Vec2.ZERO,this.p1_=cc.Vec2.ZERO,this.p2_=cc.Vec2.ZERO,this.p3_=cc.Vec2.ZERO,t&&(this.p0=t),e&&(this.p1=e),i&&(this.p2=i),o&&(this.p3=o)}return Object.defineProperty(t.prototype,"p0",{get:function(){return this.p0_},set:function(t){this.p0_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"p1",{get:function(){return this.p1_},set:function(t){this.p1_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"p2",{get:function(){return this.p2_},set:function(t){this.p2_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"p3",{get:function(){return this.p3_},set:function(t){this.p3_=t},enumerable:!0,configurable:!0}),t.prototype.b3X=function(t){var e=1-t,i=Math.pow(t,2),o=Math.pow(t,3),n=Math.pow(e,2);return Math.pow(e,3)*this.p0.x+3*t*n*this.p1.x+3*i*e*this.p2.x+o*this.p3.x},t.prototype.b3Y=function(t){var e=1-t,i=Math.pow(t,2),o=Math.pow(t,3),n=Math.pow(e,2);return Math.pow(e,3)*this.p0.y+3*t*n*this.p1.y+3*i*e*this.p2.y+o*this.p3.y},t.prototype.getPoint=function(t){var e,i,o=1-t,n=Math.pow(t,2),r=Math.pow(t,3),c=Math.pow(o,2),a=Math.pow(o,3);return e=a*this.p0.x+3*t*c*this.p1.x+3*n*o*this.p2.x+r*this.p3.x,i=a*this.p0.y+3*t*c*this.p1.y+3*n*o*this.p2.y+r*this.p3.y,cc.v2(e,i)},t.prototype.getFirstDerivative=function(t){var e,i,o=1-t,n=Math.pow(t,2),r=Math.pow(o,2);return e=3*r*(this.p1.x-this.p0.x)+6*o*t*(this.p2.x-this.p1.x)+3*n*(this.p3.x-this.p2.x),i=3*r*(this.p1.y-this.p0.y)+6*o*t*(this.p2.y-this.p1.y)+3*n*(this.p3.y-this.p2.y),cc.v2(e,i)},t.prototype.getVelocity=function(t){return this.getFirstDerivative(t)},t.prototype.getDirection=function(t){return this.getVelocity(t).normalize()},t.prototype.t2rt=function(t){var e,i,o=this.p0.x+(this.p3.x-this.p0.x)*t;e=1,i=0;do{i>0?e-=e/2:e+=e/2,i=this.b3X(e)-o}while(i>1e-7);return e},t.prototype.t2rt2=function(t){for(var e,i=t*this.length(1),o=t;;){if(e=o-(this.length(o)-i)/this.bezeSpeed(o),Math.abs(o-e)<1e-5)break;o=e}return e},t.prototype.invert=function(t,e){for(var i,o=t;;){if(i=o-(this.length(o)-e)/this.bezeSpeed(o),Math.abs(o-i)<1e-5)break;o=i}return i},t.prototype.length=function(t){var e,i,o=1e5*t,n=0,r=0,c=0;if(0===o)return 0;for(o%2==0&&o++,e=o/2,i=t/o;n<e;)r+=this.bezeSpeed((2*n+1)*i),n++;for(n=1;n<e;)c+=this.bezeSpeed(2*n*i),n++;return(this.bezeSpeed(0)+this.bezeSpeed(1)+2*c+4*r)*i/3},t.prototype.bezeSpeedX=function(t){var e=1-t,i=Math.pow(t,2),o=Math.pow(e,2);return-3*this.p0.x*o+3*this.p1.x*o-6*this.p1.x*e*t+6*this.p2.x*e*t-3*this.p2.x*i+3*this.p3.x*i},t.prototype.bezeSpeedY=function(t){var e=1-t,i=Math.pow(t,2),o=Math.pow(e,2);return-3*this.p0.y*o+3*this.p1.y*o-6*this.p1.y*e*t+6*this.p2.y*e*t-3*this.p2.y*i+3*this.p3.y*i},t.prototype.bezeSpeed=function(t){var e=this.bezeSpeedX(t),i=this.bezeSpeedY(t);return Math.sqrt(Math.pow(e,2)+Math.pow(i,2))},t}();i.default=o,cc._RF.pop()},{}],drag:[function(t,e,i){"use strict";cc._RF.push(e,"5008dLco6lGnof8eZf/4l4t","drag");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./global"),c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getWorldPos=function(){var t=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);return cc.v2(t.x,t.y)},e.prototype.setWorldPos=function(t){var e=this.node.parent.convertToNodeSpaceAR(t),i=cc.v2(e.x,e.y);this.node.position=i},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){},e.prototype.lateUpdate=function(){},e.prototype.onDestroy=function(){},e.prototype.onEnable=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){r.default.eventListener.fire("DRAG_START",t.node.name)},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.setWorldPos(e.getLocation()),r.default.eventListener.fire("DRAG_MOVE",t.node.name)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){r.default.eventListener.fire("DRAG_END",t.node.name)},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){},this)},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START),this.node.off(cc.Node.EventType.TOUCH_MOVE),this.node.off(cc.Node.EventType.TOUCH_END),this.node.off(cc.Node.EventType.TOUCH_CANCEL)},e=n([a],e)}(cc.Component));i.default=s,cc._RF.pop()},{"./global":"global"}],eventlistener:[function(t,e,i){"use strict";cc._RF.push(e,"1f05fMQieFIf4//LnIddjeI","eventlistener"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.es={}}return t.prototype.on=function(t,e,i){void 0===i&&(i=!1),this.es[t]||(this.es[t]=[]),this.es[t].push({cb:e,once:i})},t.prototype.once=function(t,e){this.on(t,e,!0)},t.prototype.fire=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var o=this.es[t]||[],n=o.length,r=0;r<n;r++){var c=o[r],a=c.cb,s=c.once;a.apply(this,e),s&&(o.splice(r,1),r--,n--)}},t.prototype.off=function(t,e){if(void 0===t)this.es={};else if(void 0===e)delete this.es[t];else for(var i=this.es[t]||[],o=i.length,n=0;n<o;n++)i[n].cb===e&&(i.splice(n,1),n--,o--)},t.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.fire.apply(this,[t].concat(e))},t}();i.default=o,cc._RF.pop()},{}],fontbinpacker:[function(t,e,i){"use strict";cc._RF.push(e,"14903HGV6FN17pUWbQSM32/","fontbinpacker"),Object.defineProperty(i,"__esModule",{value:!0});i.BestShortSideFit=0;i.BestLongSideFit=1;i.BestAreaFit=2;i.BottomLeftRule=3;i.ContactPointRule=4;var o=function(){function t(t,e,i){void 0===i&&(i=!1),this.binWidth=0,this.binHeight=0,this.allowRotate=!1,this.usedRectangles=new Array,this.freeRectangles=new Array,this.freeRectanglesLength=0,this.isSuccessBinPack=!1,this._init(t,e,i)}return t.prototype._init=function(t,e,i){this.binWidth=t,this.binHeight=e,this.allowRotate=i||!1,this.usedRectangles.length=0,this.freeRectangles.length=0,this.freeRectangles.push(new cc.Rect(0,0,t,e))},t.prototype.insert=function(t,e,i){var o=new cc.Rect,n={value:0},r={value:0};switch(i=i||0){case 0:o=this._findPositionForNewNodeBestShortSideFit(t,e,n,r);break;case 3:o=this._findPositionForNewNodeBottomLeft(t,e,n,r);break;case 4:o=this._findPositionForNewNodeContactPoint(t,e,n);break;case 1:o=this._findPositionForNewNodeBestLongSideFit(t,e,r,n);break;case 2:o=this._findPositionForNewNodeBestAreaFit(t,e,n,r)}return 0===o.height?o:(this._placeRectangle(o),o)},t.prototype.insert2=function(t,e){this.freeRectanglesLength=t.length;for(var i=new Array;t.length>0;){for(var o=1/0,n=1/0,r=-1,c=new cc.Rect,a=0;a<t.length;a++){var s={value:0},p={value:0},h=this._scoreRectangle(t[a].width,t[a].height,e,s,p);(s.value<o||s.value===o&&p.value<n)&&(o=s.value,n=p.value,c=h,r=a)}if(-1===r)return i;this._placeRectangle(c);var l=t.splice(r,1)[0];l.x=c.x,l.y=c.y,i.push(l)}return i.length===this.freeRectanglesLength&&(this.isSuccessBinPack=!0),i},t.prototype.isBinPackSuccess=function(){return this.isSuccessBinPack},t.prototype._placeRectangle=function(t){for(var e=this.freeRectangles.length,i=0;i<e;i++)this._splitFreeNode(this.freeRectangles[i],t)&&(this.freeRectangles.splice(i,1),i--,e--);this._pruneFreeList(),this.usedRectangles.push(t)},t.prototype._scoreRectangle=function(t,e,i,o,n){var r=new cc.Rect;switch(o.value=1/0,n.value=1/0,i){case 0:r=this._findPositionForNewNodeBestShortSideFit(t,e,o,n);break;case 3:r=this._findPositionForNewNodeBottomLeft(t,e,o,n);break;case 4:r=this._findPositionForNewNodeContactPoint(t,e,o);break;case 1:r=this._findPositionForNewNodeBestLongSideFit(t,e,n,o);break;case 2:r=this._findPositionForNewNodeBestAreaFit(t,e,o,n)}return 0===r.height&&(o.value=1/0,n.value=1/0),r},t.prototype._occupancy=function(){for(var t=this.usedRectangles,e=0,i=0;i<t.length;i++)e+=t[i].width*t[i].height;return e/(this.binWidth*this.binHeight)},t.prototype.wastedBinArea=function(){for(var t=this.usedRectangles,e=0,i=0;i<t.length;i++)e+=t[i].width*t[i].height;return this.binWidth*this.binHeight-e},t.prototype._findPositionForNewNodeBottomLeft=function(t,e,i,o){var n,r,c=this.freeRectangles,a=new cc.Rect;i.value=1/0;for(var s=0;s<c.length;s++)(n=c[s]).width>=t&&n.height>=e&&((r=n.y+e)<i.value||r===i.value&&n.x<o.value)&&(a.x=n.x,a.y=n.y,a.width=t,a.height=e,i.value=r,o.value=n.x),this.allowRotate&&n.width>=e&&n.height>=t&&((r=n.y+t)<i.value||r===i.value&&n.x<o.value)&&(a.x=n.x,a.y=n.y,a.width=e,a.height=t,i.value=r,o.value=n.x);return a},t.prototype._findPositionForNewNodeBestShortSideFit=function(t,e,i,o){var n,r,c,a,s,p=this.freeRectangles,h=new cc.Rect;i.value=1/0;for(var l=0;l<p.length;l++){(n=p[l]).width>=t&&n.height>=e&&(r=Math.abs(n.width-t),c=Math.abs(n.height-e),a=Math.min(r,c),s=Math.max(r,c),(a<i.value||a===i.value&&s<o.value)&&(h.x=n.x,h.y=n.y,h.width=t,h.height=e,i.value=a,o.value=s));var u=void 0,f=void 0,d=void 0,g=void 0;this.allowRotate&&n.width>=e&&n.height>=t&&(u=Math.abs(n.width-e),f=Math.abs(n.height-t),d=Math.min(u,f),g=Math.max(u,f),(d<i.value||d===i.value&&g<o.value)&&(h.x=n.x,h.y=n.y,h.width=e,h.height=t,i.value=d,o.value=g))}return h},t.prototype._findPositionForNewNodeBestLongSideFit=function(t,e,i,o){var n,r,c,a,s,p=this.freeRectangles,h=new cc.Rect;o.value=1/0;for(var l=0;l<p.length;l++)(n=p[l]).width>=t&&n.height>=e&&(r=Math.abs(n.width-t),c=Math.abs(n.height-e),a=Math.min(r,c),((s=Math.max(r,c))<o.value||s===o.value&&a<i.value)&&(h.x=n.x,h.y=n.y,h.width=t,h.height=e,i.value=a,o.value=s)),this.allowRotate&&n.width>=e&&n.height>=t&&(r=Math.abs(n.width-e),c=Math.abs(n.height-t),a=Math.min(r,c),((s=Math.max(r,c))<o.value||s===o.value&&a<i.value)&&(h.x=n.x,h.y=n.y,h.width=e,h.height=t,i.value=a,o.value=s));return h},t.prototype._findPositionForNewNodeBestAreaFit=function(t,e,i,o){var n,r,c,a,s,p=this.freeRectangles,h=new cc.Rect;i.value=1/0;for(var l=0;l<p.length;l++)s=(n=p[l]).width*n.height-t*e,n.width>=t&&n.height>=e&&(r=Math.abs(n.width-t),c=Math.abs(n.height-e),a=Math.min(r,c),(s<i.value||s===i.value&&a<o.value)&&(h.x=n.x,h.y=n.y,h.width=t,h.height=e,o.value=a,i=s)),this.allowRotate&&n.width>=e&&n.height>=t&&(r=Math.abs(n.width-e),c=Math.abs(n.height-t),a=Math.min(r,c),(s<i.value||s===i.value&&a<o.value)&&(h.x=n.x,h.y=n.y,h.width=e,h.height=t,o.value=a,i.value=s));return h},t.prototype._commonIntervalLength=function(t,e,i,o){return e<i||o<t?0:Math.min(e,o)-Math.max(t,i)},t.prototype._contactPointScoreNode=function(t,e,i,o){var n,r=this.usedRectangles,c=0;0!==t&&t+i!==this.binWidth||(c+=o),0!==e&&e+o!==this.binHeight||(c+=i);for(var a=0;a<r.length;a++)(n=r[a]).x!==t+i&&n.x+n.width!==t||(c+=this._commonIntervalLength(n.y,n.y+n.height,e,e+o)),n.y!==e+o&&n.y+n.height!==e||(c+=this._commonIntervalLength(n.x,n.x+n.width,t,t+i));return c},t.prototype._findPositionForNewNodeContactPoint=function(t,e,i){var o,n,r=this.freeRectangles,c=new cc.Rect;i.value=-1;for(var a=0;a<r.length;a++)(o=r[a]).width>=t&&o.height>=e&&(n=this._contactPointScoreNode(o.x,o.y,t,e))>i.value&&(c.x=o.x,c.y=o.y,c.width=t,c.height=e,i=n),this.allowRotate&&o.width>=e&&o.height>=t&&(n=this._contactPointScoreNode(o.x,o.y,e,t))>i.value&&(c.x=o.x,c.y=o.y,c.width=e,c.height=t,i.value=n);return c},t.prototype._splitFreeNode=function(t,e){var i,o=this.freeRectangles;return!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y)&&(e.x<t.x+t.width&&e.x+e.width>t.x&&(e.y>t.y&&e.y<t.y+t.height&&((i=t.clone()).height=e.y-i.y,o.push(i)),e.y+e.height<t.y+t.height&&((i=t.clone()).y=e.y+e.height,i.height=t.y+t.height-(e.y+e.height),o.push(i))),e.y<t.y+t.height&&e.y+e.height>t.y&&(e.x>t.x&&e.x<t.x+t.width&&((i=t.clone()).width=e.x-i.x,o.push(i)),e.x+e.width<t.x+t.width&&((i=t.clone()).x=e.x+e.width,i.width=t.x+t.width-(e.x+e.width),o.push(i))),!0)},t.prototype._pruneFreeList=function(){for(var t=this.freeRectangles,e=0;e<t.length;e++)for(var i=e+1;i<t.length;i++)if(t[e].containsRect(t[i])&&(t.splice(i,1),i--),t[i].containsRect(t[e])){t.splice(e,1),e--;break}},t}();i.FontBinPacker=o,cc._RF.pop()},{}],fonttest:[function(t,e,i){"use strict";cc._RF.push(e,"ac2fdzlanVCUoFWrt1z9iHO","fonttest");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../basedraw"),c=t("./rect"),a=t("./fontbinpacker"),s=cc._decorator,p=s.ccclass,h=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.start=function(){var t=new Array;t.push(new c.Rect(1,0,0,80,80)),t.push(new c.Rect(2,0,0,80,80)),t.push(new c.Rect(3,0,0,80,80)),t.push(new c.Rect(4,0,0,80,80)),t.push(new c.Rect(5,0,0,80,80)),t.push(new c.Rect(6,0,0,80,80)),t.push(new c.Rect(7,0,0,80,80)),t.push(new c.Rect(8,0,0,80,80));for(var e=new a.FontBinPacker(256,512,!1).insert2(t,0),i=0;i<e.length;i++)this.drawRectPoint(cc.v2(e[i].x,-(e[i].y+e[i].height)),cc.Color.RED,e[i].width,e[i].height,!1)},e=n([p],e)}(r.default));i.default=h,cc._RF.pop()},{"../basedraw":"basedraw","./fontbinpacker":"fontbinpacker","./rect":"rect"}],fontutil:[function(t,e,i){"use strict";cc._RF.push(e,"d0b3214RNBKTKpjfwx9Vteo","fontutil"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./binpackbuilder"),n=function(){function t(){}return t.run=function(t){var e={width:0,height:0};this.getImageRects(t,e);var i=new o.default;return i.init(e.width,e.height,t),i.build()||(i=null),i},t.genFontFnt=function(e,i,o,n,r,c,a){var s=t.genInfo(e,"0","0","0","ANSI","0","0","1","1","0,0,0,0","0,0");s+=t.genCommon(o.toString(),"0",n.toString(),r.toString(),"1","0"),s+=t.genPage("0",e+".png"),s+=t.genChars(c+1),s+=t.genChar(this.getCharId(" ").toString(),"0","0","0","0","0","0",a.toString(),"0","0");for(var p=0;p<i.length;p++){var h=i[p];s+=t.genChar(this.getCharId(h.char).toString(),h.imgSize.x.toString(),h.imgSize.y.toString(),h.imgSize.width.toString(),h.imgSize.height.toString(),"0","0",h.imgSize.width.toString(),"0","0")}return t.saveToFile(s,e),!0},t.getImageRects=function(t,e){for(var i=new Array,o=0,n=0;n<t.length;n++){var r=t[n];i.push(r),o+=r.width*r.height}for(var c=1,a=1;;){if(!(o>Math.pow(2,c)*Math.pow(2,a)))break;c<=a?c++:a++}var s=Math.pow(2,c),p=Math.pow(2,a);return e.width=s,e.height=p,i},t.getCharId=function(t){return t.charAt(0).charCodeAt(0)},t.genInfo=function(t,e,i,o,n,r,c,a,s,p,h){var l='info face="{0}" size={1} bold={2} italic={3} charset="{4}" unicode={5} stretchH={6} smooth={7} aa={8} padding={9} spacing={10}\n';return l=this.stringFormat(l,t,e,i,o,n,r,c,a,s,p,h)},t.genCommon=function(t,e,i,o,n,r){var c="common lineHeight={0} base={1} scaleW={2} scaleH={3} pages={4} packed={5}\n";return c=this.stringFormat(c,t,e,i,i,n,r)},t.genPage=function(t,e){var i='page id={0} file="{1}"\n';return i=this.stringFormat(i,t,e)},t.genChars=function(t){var e="chars count={0}\n\n";return e=this.stringFormat(e,t)},t.genChar=function(t,e,i,o,n,r,c,a,s,p){var h="char  id={0}  x={1}  y={2}  width={3}  height={4}  xoffset={5}  yoffset={6}  xadvance={7}  page={8}  chnl={9}\n";return h=this.stringFormat(h,t,e,i,o,n,r,c,a,s,p)},t.stringFormat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t[0],o=0;o<t.length-1;o++)if(void 0!=t[o+1]){var n=new RegExp("\\{"+o+"\\}","gm");i=i.replace(n,t[o+1])}return i},t.saveToFile=function(t,e){if(void 0===e&&(e="default.fnt"),cc.sys.isBrowser){var i=new Blob([t],{type:"text/plain"}),o=e+".fnt",n=document.createElement("a");n.download=o,n.innerHTML="Download File",null!=window.URL?n.href=window.URL.createObjectURL(i):(n.href=window.URL.createObjectURL(i),n.style.display="none",document.body.appendChild(n)),n.click(),document.body.removeChild(n)}},t}();i.FontUtil=n,cc._RF.pop()},{"./binpackbuilder":"binpackbuilder"}],global:[function(t,e,i){"use strict";cc._RF.push(e,"92eb2MSw+FJvq0Mq7Ff+ehi","global"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("./eventlistener");(function(t){t[t.FREE=0]="FREE",t[t.ALIGNED=1]="ALIGNED",t[t.MIRRORED=2]="MIRRORED",t[t.CLOSE=3]="CLOSE"})(o=i.ControlMode||(i.ControlMode={}));var r=function(){function t(){}return t.getInstance=function(){return t.instance_},Object.defineProperty(t,"eventListener",{get:function(){return this.eventListenter_},set:function(t){this.eventListenter_=t},enumerable:!0,configurable:!0}),t.instance_=new t,t.eventListenter_=new n.default,t.controlMode=o.FREE,t}();i.default=r,cc._RF.pop()},{"./eventlistener":"eventlistener"}],itemmgr:[function(t,e,i){"use strict";cc._RF.push(e,"85c58DSqDRCyJo7aJdGr3Ug","itemmgr");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=r.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefab=null,e.size=5,e.pool_=null,e}return o(e,t),Object.defineProperty(e.prototype,"pool",{get:function(){return this.pool_},set:function(t){this.pool_=t},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){if(this.size<1)throw Error("size < 1");if(null===this.prefab)throw Error("prefab null");for(var t=new cc.NodePool,e=0;e<this.size;e++)t.put(cc.instantiate(this.prefab));this.pool=t},e.prototype.createItem=function(){return this.pool.size()>0?this.pool.get():cc.instantiate(this.prefab)},e.prototype.deleteItem=function(t){this.pool.put(t)},e.prototype.clearPool=function(){this.pool.clear()},n([a(cc.Prefab)],e.prototype,"prefab",void 0),n([a],e.prototype,"size",void 0),e=n([c],e)}(cc.Component);i.default=s,cc._RF.pop()},{}],itemui:[function(t,e,i){"use strict";cc._RF.push(e,"3ce16OIAQ9O7YzfFELIUmuS","itemui");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../global"),c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.didEnded=function(t){var e=this.getId(),i=this.node.getChildByName("char").getComponent(cc.EditBox);if(""===i.string){var o=this.node.getChildByName("imgpath").getComponent(cc.Label);i.string=o.string.charAt(0)}r.default.eventListener.fire("CHANGE_CHAR",e,i.string)},e.prototype.onOperator=function(){var t=this.getId();r.default.eventListener.fire("REMOVE_ITEM",t)},e.prototype.getId=function(){var t=this.node.getChildByName("id").getComponent(cc.Label);return parseInt(t.string)},e=n([a],e)}(cc.Component));i.default=s,cc._RF.pop()},{"../global":"global"}],item:[function(t,e,i){"use strict";cc._RF.push(e,"5c047ddBgxBr6e08x4rLdYa","item"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./rect"),n=function(){return function(){this.id=0,this.img=null,this.imgPath="",this.imgSize=new o.Rect(0,0,0,0),this.char="",this.size=0,this.node=null}}();i.default=n,cc._RF.pop()},{"./rect":"rect"}],menu:[function(t,e,i){"use strict";cc._RF.push(e,"6f18ePtmTdPgaGaBvSHhpMF","menu");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.toBMFontScene=function(){cc.director.loadScene("BMFont")},e.prototype.toBSplineCurveScene=function(){cc.director.loadScene("Curve")},e=n([c],e)}(cc.Component));i.default=a,cc._RF.pop()},{}],pointmgr:[function(t,e,i){"use strict";cc._RF.push(e,"066c0eVF+ZC3JBQeHD9Y+tp","pointmgr");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=r.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefab=null,e.size=5,e.pool_=null,e}return o(e,t),Object.defineProperty(e.prototype,"pool",{get:function(){return this.pool_},set:function(t){this.pool_=t},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){if(this.size<1)throw Error("size < 1");if(null===this.prefab)throw Error("prefab null");for(var t=new cc.NodePool,e=0;e<this.size;e++)t.put(cc.instantiate(this.prefab));this.pool=t},e.prototype.createPoint=function(){return this.pool.size()>0?this.pool.get():cc.instantiate(this.prefab)},e.prototype.deletePoint=function(t){this.pool.put(t)},e.prototype.clearPool=function(){this.pool.clear()},n([a(cc.Prefab)],e.prototype,"prefab",void 0),n([a],e.prototype,"size",void 0),e=n([c],e)}(cc.Component);i.default=s,cc._RF.pop()},{}],rect:[function(t,e,i){"use strict";cc._RF.push(e,"d27d3bVv+5OzYbKrZDd8sYC","rect");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){function e(e,i,o,n,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===n&&(n=0),void 0===r&&(r=0);var c=t.call(this,i,o,n,r)||this;return c.id=0,c.id=e,c}return o(e,t),e}(cc.Rect);i.Rect=n,cc._RF.pop()},{}],saveimage:[function(t,e,i){"use strict";cc._RF.push(e,"bbb3bTLVItI9rdGaa867Uge","saveimage");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../global"),c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.camera=null,e}return o(e,t),e.prototype.onLoad=function(){var t=this;r.default.eventListener.on("GENERATE_IMAGE",function(e){t.init(),t.downloadImg(e)})},e.prototype.onDestroy=function(){r.default.eventListener.off("GENERATE_IMAGE")},e.prototype.init=function(){var t=new cc.RenderTexture,e=cc.game._renderContext;t.initWithSize(this.node.width,this.node.height,e.STENCIL_INDEX8),this.camera.targetTexture=t,this.camera.node.position=cc.v2(.5*this.node.width,.5*-this.node.height),this._texture=t},e.prototype.initImage=function(){var t=this._canvas.toDataURL("image/png"),e=document.createElement("img");return e.src=t,e},e.prototype.createSprite=function(){var t=this._texture.width,e=this._texture.height;this._canvas?this.clearCanvas():(this._canvas=document.createElement("canvas"),this._canvas.width=t,this._canvas.height=e);var i=this._canvas.getContext("2d");this.camera.render(this.node);for(var o=this._texture.readPixels(),n=4*t,r=0;r<e;r++){for(var c=e-1-r,a=i.createImageData(t,1),s=c*t*4,p=0;p<n;p++)a.data[p]=o[s+p];i.putImageData(a,0,r)}return this._canvas},e.prototype.downloadImg=function(t){this.createSprite();var e=this._canvas.toDataURL("image/png"),i=document.createElement("a");i.href=e,i.download=t+".png",document.body.appendChild(i),i.click(),document.body.removeChild(i)},e.prototype.clearCanvas=function(){this._canvas.getContext("2d").clearRect(0,0,this._canvas.width,this._canvas.height)},n([s(cc.Camera)],e.prototype,"camera",void 0),e=n([a],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../global":"global"}],showposition:[function(t,e,i){"use strict";cc._RF.push(e,"155093iTH1A8IVyOAQv3j6Q","showposition");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=r.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return o(e,t),e.prototype.update=function(t){this.label.string="("+this.node.position.x.toFixed(1)+","+this.node.position.y.toFixed(1)+")"},n([a(cc.Label)],e.prototype,"label",void 0),e=n([c],e)}(cc.Component);i.default=s,cc._RF.pop()},{}],test:[function(t,e,i){"use strict";cc._RF.push(e,"f9fe0vwM/dDoILCxcdJqPp6","test");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./basedraw"),c=t("./pointmgr"),a=t("./beziernode"),s=t("./global"),p=cc._decorator,h=p.ccclass,l=p.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frame=null,e.pointMgr=null,e.bezierNodeList=new Array,e.time=0,e.playTime=20,e.isPlay=!1,e.totalLength=0,e.lineLengthList=new Array,e.pointList=new Array,e.isAddPoint=!1,e}return o(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.pointMgr=cc.find("Canvas/PointMgr").getComponent(c.default),s.default.eventListener.on("ADD_SPLINE",function(){e.isPlay=!1,e.isAddPoint=!1,e.pointList.length=0,e.addBezierNode()}),s.default.eventListener.on("DELETE_SPLINE",function(){e.isPlay=!1,e.isAddPoint=!1,e.pointList.length=0,e.removeBezierNode()}),s.default.eventListener.on("DELETE_ALL_SPLINE",function(){for(e.isPlay=!1,e.isAddPoint=!1,e.pointList.length=0;e.bezierNodeList.length>0;)e.removeBezierNode()}),s.default.eventListener.on("EDITOR_SCALE_SMALL",function(){var t=e.node.scale;e.node.scale=.5*t,e.frame.scale=.5*t}),s.default.eventListener.on("EDITOR_SCALE_BIG",function(){var t=e.node.scale;e.node.scale=2*t,e.frame.scale=2*t}),s.default.eventListener.on("EDITOR_SCALE_RESTORE",function(){e.node.scale=1,e.frame.scale=1,e.node.position=cc.v2(0,0),e.frame.position=cc.v2(0,0)}),s.default.eventListener.on("ARROW_L",function(){var t=e.node.position;e.node.position=t.add(cc.v2(-1,0)),e.frame.position=t.add(cc.v2(-1,0))}),s.default.eventListener.on("ARROW_U",function(){var t=e.node.position;e.node.position=t.add(cc.v2(0,1)),e.frame.position=t.add(cc.v2(0,1))}),s.default.eventListener.on("ARROW_R",function(){var t=e.node.position;e.node.position=t.add(cc.v2(1,0)),e.frame.position=t.add(cc.v2(1,0))}),s.default.eventListener.on("ARROW_D",function(){var t=e.node.position;e.node.position=t.add(cc.v2(0,-1)),e.frame.position=t.add(cc.v2(0,-1))}),s.default.eventListener.on("PLAY",function(){if(0!==e.bezierNodeList.length){e.isPlay=!0,e.totalLength=0,e.lineLengthList.splice(0,e.lineLengthList.length);for(var t=0;t<e.bezierNodeList.length;t++){var i=e.bezierNodeList[t].getLength(1);e.totalLength+=i,e.lineLengthList[t]=i}e.isAddPoint=!0,e.time=0}}),s.default.eventListener.on("STOP",function(){e.isAddPoint=!1,e.pointList.length=0,e.isPlay=!1}),s.default.eventListener.on("CLICK_SAVE",function(t){if("path"===t){for(var i=new Array,o=0;o<e.pointList.length;o++){var n=e.pointList[o],r=new cc.Vec2(parseFloat(n.x.toFixed(2)),parseFloat(n.y.toFixed(2)));i.push(r)}s.default.eventListener.fire("SAVE",JSON.stringify(i))}else if("ctrl"===t){var c=[];for(o=0;o<e.bezierNodeList.length;o++){var a=e.bezierNodeList[o],p={p0:a.p0p,p1:a.p1p,p2:a.p2p,p3:a.p3p};c.push(p)}s.default.eventListener.fire("SAVE",JSON.stringify(c))}}),s.default.eventListener.on("SET_CHANGE_PLAY_TIME",function(t){e.playTime=t}),s.default.eventListener.on("CONTROL_MODE_CHANGE",function(){e.isAddPoint=!1,e.isPlay=!1,e.pointList.length=0;var t=e.bezierNodeList.length;if(t>0){var i=e.bezierNodeList[0],o=e.bezierNodeList[t-1];if(s.default.controlMode===s.ControlMode.CLOSE)e.pointMgr.deletePoint(o.p3),o.p3=i.p0;else if(o.p3.name===i.p0.name){var n=e.pointMgr.createPoint(),r=3*t;n.name="Node"+r,n.position=i.p0.position,e.node.addChild(n),o.p3=n}}}),s.default.eventListener.on("DRAG_START",function(t){cc.log("-----------DRAG_START-----------");var i=Number(t.substring(4)),o=e.bezierNodeList.length;if(0===i)cc.log(0);else if(i>0&&i%3==0){var n=i/3-1,r=i/3;o===r?cc.log(n):(cc.log(n),cc.log(r))}else if(i>0&&i%3!=0){var c=Math.floor(i/3);cc.log(c)}}),s.default.eventListener.on("DRAG_MOVE",function(t){e.isAddPoint=!1,e.isPlay=!1,e.pointList.length=0;var i=Number(t.substring(4)),o=e.bezierNodeList.length;if(0===i)cc.log(0);else if(i>0&&i%3==0){var n=i/3-1,r=i/3;o===r?cc.log(n):(cc.log(n),cc.log(r))}else if(i>0&&i%3!=0){var c=Math.floor(i/3),a=i%3;if(cc.log(c),o>1&&i>1&&i<3*o-1){var p=e.bezierNodeList[c],h=null,l=null,u=null;if(1===a)h=e.bezierNodeList[c-1].p2,l=p.p0,u=p.p1;else if(2===a){h=e.bezierNodeList[c+1].p1,l=p.p3,u=p.p2}if(h&&l){var f=u.position.sub(l.position);if(s.default.controlMode===s.ControlMode.ALIGNED){var d=h.position.sub(l.position).mag();h.position=l.position.add(f.neg().normalize().mul(d))}else s.default.controlMode===s.ControlMode.MIRRORED&&(h.position=l.position.add(f.neg()))}}}}),s.default.eventListener.on("DRAG_END",function(t){var i=Number(t.substring(4)),o=e.bezierNodeList.length;if(0===i)cc.log(0);else if(i>0&&i%3==0){var n=i/3-1,r=i/3;o===r?cc.log(n):(cc.log(n),cc.log(r))}else if(i>0&&i%3!=0){var c=Math.floor(i/3);cc.log(c)}})},e.prototype.onDestroy=function(){s.default.eventListener.off("ADD_SPLINE"),s.default.eventListener.off("DELETE_SPLINE"),s.default.eventListener.off("DELETE_ALL_SPLINE"),s.default.eventListener.off("EDITOR_SCALE_SMALL"),s.default.eventListener.off("EDITOR_SCALE_BIG"),s.default.eventListener.off("EDITOR_SCALE_RESTORE"),s.default.eventListener.off("ARROW_L"),s.default.eventListener.off("ARROW_U"),s.default.eventListener.off("ARROW_R"),s.default.eventListener.off("ARROW_D"),s.default.eventListener.off("PLAY"),s.default.eventListener.off("STOP"),s.default.eventListener.off("CLICK_SAVE"),s.default.eventListener.off("SET_CHANGE_PLAY_TIME"),s.default.eventListener.off("CONTROL_MODE_CHANGE"),s.default.eventListener.off("DRAG_START"),s.default.eventListener.off("DRAG_MOVE"),s.default.eventListener.off("DRAG_END")},e.prototype.addBezierNode=function(){var t=this.bezierNodeList.length;if(0===t){var e=this.pointMgr.createPoint(),i=this.pointMgr.createPoint(),o=this.pointMgr.createPoint(),n=e;e.name="Node0",i.name="Node1",o.name="Node2",e.position=cc.v2(-640,0),i.position=cc.v2(-500,140),o.position=cc.v2(-500,-140),this.node.addChild(e),this.node.addChild(i),this.node.addChild(o),s.default.controlMode!=s.ControlMode.CLOSE&&((n=this.pointMgr.createPoint()).name="Node3",n.position=cc.v2(-360,0),this.node.addChild(n)),(l=new a.default(e,i,o,n)).index=0,this.bezierNodeList.push(l)}else{var r=this.bezierNodeList[t-1],c=r.p3,p=this.pointMgr.createPoint(),h=(e=c,i=this.pointMgr.createPoint(),o=this.pointMgr.createPoint(),n=p,3*t);i.name="Node"+(h+1),o.name="Node"+(h+2),n.name="Node"+(h+3);var l,u=c.position.x,f=c.position.y;i.position=cc.v2(u+140,f+140),o.position=cc.v2(u+140,f-140),n.position=cc.v2(u+280,f),s.default.controlMode===s.ControlMode.CLOSE?(n=c,(e=p).name="Node"+h,n.name=c.name,e.position=c.position,n.position=c.position,this.node.addChild(e),this.node.addChild(i),this.node.addChild(o),r.p3=e):(this.node.addChild(i),this.node.addChild(o),this.node.addChild(n)),(l=new a.default(e,i,o,n)).index=t,this.bezierNodeList.push(l)}},e.prototype.removeBezierNode=function(){var t=this.bezierNodeList.length;if(t>1){var e=this.bezierNodeList[t-2],i=this.bezierNodeList[t-1];this.pointMgr.deletePoint(i.p1),this.pointMgr.deletePoint(i.p2),s.default.controlMode==s.ControlMode.CLOSE?(this.pointMgr.deletePoint(e.p3),e.p3=i.p3):this.pointMgr.deletePoint(i.p3),this.bezierNodeList.pop()}else if(1===t){i=this.bezierNodeList[t-1];this.pointMgr.deletePoint(i.p0),this.pointMgr.deletePoint(i.p1),this.pointMgr.deletePoint(i.p2),s.default.controlMode!=s.ControlMode.CLOSE&&this.pointMgr.deletePoint(i.p3),this.bezierNodeList.pop()}},e.prototype.update=function(t){for(var e in this.clearDraw(),this.bezierNodeList)if(this.bezierNodeList.hasOwnProperty(e)){var i=this.bezierNodeList[e];i.updatePosition(t),this.setStrokeColor(cc.Color.BLUE),this.setLineWidth(2),this.drawBezierCurve(i.p0p,i.p1p,i.p2p,i.p3p),this.drawLine(i.p0p,i.p1p,new cc.Color(0,255,0,50),2),this.drawLine(i.p2p,i.p3p,new cc.Color(0,255,0,50),2)}!0===this.isPlay&&(this.time+=t,this.updatePoint())},e.prototype.updatePoint=function(){for(var t=0;t<this.pointList.length;t++)this.drawCirclePoint(this.pointList[t],cc.Color.RED,3,!0);if(this.time<this.playTime){for(var e=this.totalLength,i=this.time/this.playTime,o=e*i,n=this.bezierNodeList.length,r=0,c=0;c<n;c++)if((o-=this.lineLengthList[c])<0){r=c;break}i=(o+=this.lineLengthList[r])/this.lineLengthList[r];var a=this.bezierNodeList[r].cubicBezier.invert(i,o),s=this.bezierNodeList[r].cubicBezier.getPoint(a);cc.color(Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random()));this.drawCirclePoint(s,cc.Color.GREEN,3,!0),this.isAddPoint&&this.pointList.push(s)}else this.time=0,this.isAddPoint=!1},n([l(cc.Node)],e.prototype,"frame",void 0),e=n([h],e)}(r.default);i.default=u,cc._RF.pop()},{"./basedraw":"basedraw","./beziernode":"beziernode","./global":"global","./pointmgr":"pointmgr"}],ui:[function(t,e,i){"use strict";cc._RF.push(e,"4d0e5+IXqtAZ7+iLHHNV/Rg","ui");var o=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),n=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(r<3?n(c):r>3?n(e,i,c):n(e,i))||c);return r>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./global"),c=t("./drag"),a=cc._decorator,s=a.ccclass,p=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.input=null,e}return o(e,t),e.prototype.onLoad=function(){var t=this;this.setReferenceDraggable(!1),this.createFileLoader(),r.default.eventListener.on("SAVE",function(e){t.saveToFile(e)})},e.prototype.onDestroy=function(){r.default.eventListener.off("SAVE")},e.prototype.createFileLoader=function(){var t=this;if(cc.sys.isBrowser)if(window.File&&window.FileReader&&window.FileList&&window.Blob){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.setAttribute("style","position:absolute;margin-left:0%;margin-top:0px;-webkit-user-select:file;display:none"),document.getElementsByTagName("body")[0].appendChild(e);e.addEventListener("change",function(e){var i=e.target.files[0];if(!i.type.match("image.*"))return!1;var o=new FileReader;o.readAsDataURL(i),o.onload=function(e){var i=document.createElement("img");i.src=e.target.result;var o=new cc.Texture2D;o._nativeAsset=i,o.on("load",function(){t.sprite.spriteFrame=new cc.SpriteFrame(o)})}}),this.input=e}else alert("\u4e0d\u652f\u6301")},e.prototype.saveToFile=function(t,e){if(void 0===e&&(e="filename"),cc.sys.isBrowser){var i=new Blob([t],{type:"application/json"}),o=document.createElement("a");o.download="filename.json",o.innerHTML="Download File",null!=window.URL?o.href=window.URL.createObjectURL(i):(o.href=window.URL.createObjectURL(i),o.style.display="none",document.body.appendChild(o)),o.click(),document.body.removeChild(o)}},e.prototype.onClickUp=function(){this.node.position=cc.v2(0,40)},e.prototype.onClickDown=function(){this.node.position=cc.v2(0,-720)},e.prototype.onClickAddSpline=function(){r.default.eventListener.fire("ADD_SPLINE")},e.prototype.onClickDeleteSpline=function(){r.default.eventListener.fire("DELETE_SPLINE")},e.prototype.onClickDeleteAllSpline=function(){r.default.eventListener.fire("DELETE_ALL_SPLINE")},e.prototype.onClickScaleSmall=function(){r.default.eventListener.fire("EDITOR_SCALE_SMALL")},e.prototype.onClickScaleBig=function(){r.default.eventListener.fire("EDITOR_SCALE_BIG")},e.prototype.onClickScaleRestore=function(){r.default.eventListener.fire("EDITOR_SCALE_RESTORE")},e.prototype.onClickArrowL=function(){r.default.eventListener.fire("ARROW_L")},e.prototype.onClickArrowU=function(){r.default.eventListener.fire("ARROW_U")},e.prototype.onClickArrowR=function(){r.default.eventListener.fire("ARROW_R")},e.prototype.onClickArrowD=function(){r.default.eventListener.fire("ARROW_D")},e.prototype.onClickPlay=function(){r.default.eventListener.fire("PLAY")},e.prototype.onClickStop=function(){r.default.eventListener.fire("STOP")},e.prototype.onClickSave=function(t,e){r.default.eventListener.fire("CLICK_SAVE",e)},e.prototype.onCheckEdit=function(t,e){cc.log(t.isChecked),r.default.eventListener.fire("CHECK_EDIT")},e.prototype.onFileLoader=function(){this.input&&this.input.click()},e.prototype.onCheckReferenceEdit=function(t,e){this.setReferenceDraggable(t.isChecked)},e.prototype.setReferenceDraggable=function(t){this.sprite&&(this.sprite.getComponent(c.default).enabled=t)},e.prototype.setChangePlayTime=function(t){r.default.eventListener.fire("SET_CHANGE_PLAY_TIME",Number(t.string))},e.prototype.onControlMode=function(t,e){t.isChecked;var i=t.name.substring(0,7);"toggle1"===i?r.default.controlMode=r.ControlMode.FREE:"toggle2"===i?r.default.controlMode=r.ControlMode.ALIGNED:"toggle3"===i?r.default.controlMode=r.ControlMode.MIRRORED:"toggle4"===i&&(r.default.controlMode=r.ControlMode.CLOSE),cc.log(r.default.controlMode),r.default.eventListener.fire("CONTROL_MODE_CHANGE")},e.prototype.onBackMain=function(){cc.director.loadScene("Menu")},n([p(cc.Sprite)],e.prototype,"sprite",void 0),e=n([s],e)}(cc.Component);i.default=h,cc._RF.pop()},{"./drag":"drag","./global":"global"}]},{},["NewScript","basedraw","beziernode","binpackbuilder","bmfontui","fontbinpacker","fonttest","fontutil","item","itemmgr","itemui","rect","saveimage","cubicbezier","drag","eventlistener","global","menu","pointmgr","showposition","test","ui"]);