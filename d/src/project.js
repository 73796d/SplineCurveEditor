window.__require=function t(e,o,i){function n(c,s){if(!o[c]){if(!e[c]){var p=c.split("/");if(p=p[p.length-1],!e[p]){var a="function"==typeof __require&&__require;if(!s&&a)return a(p,!0);if(r)return r(p,!0);throw new Error("Cannot find module '"+c+"'")}}var l=o[c]={exports:{}};e[c][0].call(l.exports,function(t){return n(e[c][1][t]||t)},l,l.exports,t,e,o,i)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<i.length;c++)n(i[c]);return n}({NewScript:[function(t,e,o){"use strict";cc._RF.push(e,"45768zMRhlGzonGxOL23h9R","NewScript");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,c=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,o,c):n(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./basedraw"),c=cc._decorator,s=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){this.clearDraw(),this.drawRectPoint(cc.Vec2.ZERO,cc.Color.GREEN,10,!0),this.node.width=20,this.node.height=20},e.prototype.update=function(){this.clearDraw(),this.drawRectPoint(cc.Vec2.ZERO,cc.Color.GREEN,10,!0)},e=n([s],e)}(r.default));o.default=p,cc._RF.pop()},{"./basedraw":"basedraw"}],basedraw:[function(t,e,o){"use strict";cc._RF.push(e,"fb9f0HG4sFJjLw+g5a1GbkP","basedraw");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,c=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,o,c):n(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"graphics",{get:function(){return this.graphics_},set:function(t){this.graphics_=t},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.graphics?this.graphics=this.getComponent(cc.Graphics):this.graphics=this.addComponent(cc.Graphics)},e.prototype.setLineCap=function(t){this.graphics.lineCap=t},e.prototype.setLineJoin=function(t){this.graphics.lineJoin=t},e.prototype.setLineWidth=function(t){this.graphics.lineWidth=t},e.prototype.setStrokeColor=function(t){this.graphics.strokeColor=t},e.prototype.setFillColor=function(t){this.graphics.fillColor=t},e.prototype.drawCirclePoint=function(t,e,o,i){this.setStrokeColor(e),this.graphics.circle(t.x,t.y,o),this.graphics.stroke(),i&&(this.setFillColor(e),this.graphics.fill())},e.prototype.drawRectPoint=function(t,e,o,i){this.setStrokeColor(e),this.graphics.rect(t.x,t.y,o,o),this.graphics.stroke(),i&&(this.setFillColor(e),this.graphics.fill())},e.prototype.drawLine=function(t,e,o,i){this.setLineWidth(i),this.setStrokeColor(o),this.setLineCap(cc.Graphics.LineCap.BUTT),this.graphics.moveTo(t.x,t.y),this.graphics.lineTo(e.x,e.y),this.graphics.stroke()},e.prototype.drawBezierCurve=function(t,e,o,i){this.graphics.moveTo(t.x,t.y),this.graphics.bezierCurveTo(e.x,e.y,o.x,o.y,i.x,i.y),this.graphics.stroke()},e.prototype.clearDraw=function(){this.graphics.clear()},e=n([c],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],beziernode:[function(t,e,o){"use strict";cc._RF.push(e,"47b6bQ1kiNEIZYv4hQr6tFK","beziernode"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./cubicbezier"),n=function(){function t(t,e,o,n){this.index_=0,this.p0=null,this.p1=null,this.p2=null,this.p3=null,this.p0p=cc.Vec2.ZERO,this.p1p=cc.Vec2.ZERO,this.p2p=cc.Vec2.ZERO,this.p3p=cc.Vec2.ZERO,this.cubicBezier=null,this.p0=t,this.p1=e,this.p2=o,this.p3=n,this.cubicBezier=new i.default}return Object.defineProperty(t.prototype,"index",{get:function(){return this.index_},set:function(t){this.index_=t},enumerable:!0,configurable:!0}),t.prototype.updatePosition=function(t){this.p0p=this.p0.position,this.p1p=this.p1.position,this.p2p=this.p2.position,this.p3p=this.p3.position,this.cubicBezier.p0=this.p0p,this.cubicBezier.p1=this.p1p,this.cubicBezier.p2=this.p2p,this.cubicBezier.p3=this.p3p},t.prototype.getLength=function(t){return this.cubicBezier.length(t)},t}();o.default=n,cc._RF.pop()},{"./cubicbezier":"cubicbezier"}],cubicbezier:[function(t,e,o){"use strict";cc._RF.push(e,"8536cI4I+JNw6DtbatD2KoA","cubicbezier"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e,o,i){this.p0_=cc.Vec2.ZERO,this.p1_=cc.Vec2.ZERO,this.p2_=cc.Vec2.ZERO,this.p3_=cc.Vec2.ZERO,t&&(this.p0=t),e&&(this.p1=e),o&&(this.p2=o),i&&(this.p3=i)}return Object.defineProperty(t.prototype,"p0",{get:function(){return this.p0_},set:function(t){this.p0_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"p1",{get:function(){return this.p1_},set:function(t){this.p1_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"p2",{get:function(){return this.p2_},set:function(t){this.p2_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"p3",{get:function(){return this.p3_},set:function(t){this.p3_=t},enumerable:!0,configurable:!0}),t.prototype.b3X=function(t){var e=1-t,o=Math.pow(t,2),i=Math.pow(t,3),n=Math.pow(e,2);return Math.pow(e,3)*this.p0.x+3*t*n*this.p1.x+3*o*e*this.p2.x+i*this.p3.x},t.prototype.b3Y=function(t){var e=1-t,o=Math.pow(t,2),i=Math.pow(t,3),n=Math.pow(e,2);return Math.pow(e,3)*this.p0.y+3*t*n*this.p1.y+3*o*e*this.p2.y+i*this.p3.y},t.prototype.getPoint=function(t){var e,o,i=1-t,n=Math.pow(t,2),r=Math.pow(t,3),c=Math.pow(i,2),s=Math.pow(i,3);return e=s*this.p0.x+3*t*c*this.p1.x+3*n*i*this.p2.x+r*this.p3.x,o=s*this.p0.y+3*t*c*this.p1.y+3*n*i*this.p2.y+r*this.p3.y,cc.v2(e,o)},t.prototype.getFirstDerivative=function(t){var e,o,i=1-t,n=Math.pow(t,2),r=Math.pow(i,2);return e=3*r*(this.p1.x-this.p0.x)+6*i*t*(this.p2.x-this.p1.x)+3*n*(this.p3.x-this.p2.x),o=3*r*(this.p1.y-this.p0.y)+6*i*t*(this.p2.y-this.p1.y)+3*n*(this.p3.y-this.p2.y),cc.v2(e,o)},t.prototype.getVelocity=function(t){return this.getFirstDerivative(t)},t.prototype.getDirection=function(t){return this.getVelocity(t).normalize()},t.prototype.t2rt=function(t){var e,o,i=this.p0.x+(this.p3.x-this.p0.x)*t;e=1,o=0;do{o>0?e-=e/2:e+=e/2,o=this.b3X(e)-i}while(o>1e-7);return e},t.prototype.t2rt2=function(t){for(var e,o=t*this.length(1),i=t;;){if(e=i-(this.length(i)-o)/this.bezeSpeed(i),Math.abs(i-e)<1e-5)break;i=e}return e},t.prototype.invert=function(t,e){for(var o,i=t;;){if(o=i-(this.length(i)-e)/this.bezeSpeed(i),Math.abs(i-o)<1e-5)break;i=o}return o},t.prototype.length=function(t){var e,o,i=1e5*t,n=0,r=0,c=0;if(0==i)return 0;for(i%2==0&&i++,e=i/2,o=t/i;n<e;)r+=this.bezeSpeed((2*n+1)*o),n++;for(n=1;n<e;)c+=this.bezeSpeed(2*n*o),n++;return(this.bezeSpeed(0)+this.bezeSpeed(1)+2*c+4*r)*o/3},t.prototype.bezeSpeedX=function(t){var e=1-t,o=Math.pow(t,2),i=Math.pow(e,2);return-3*this.p0.x*i+3*this.p1.x*i-6*this.p1.x*e*t+6*this.p2.x*e*t-3*this.p2.x*o+3*this.p3.x*o},t.prototype.bezeSpeedY=function(t){var e=1-t,o=Math.pow(t,2),i=Math.pow(e,2);return-3*this.p0.y*i+3*this.p1.y*i-6*this.p1.y*e*t+6*this.p2.y*e*t-3*this.p2.y*o+3*this.p3.y*o},t.prototype.bezeSpeed=function(t){var e=this.bezeSpeedX(t),o=this.bezeSpeedY(t);return Math.sqrt(Math.pow(e,2)+Math.pow(o,2))},t}();o.default=i,cc._RF.pop()},{}],drag:[function(t,e,o){"use strict";cc._RF.push(e,"5008dLco6lGnof8eZf/4l4t","drag");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,c=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,o,c):n(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./global"),c=cc._decorator,s=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getWorldPos=function(){var t=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);return cc.v2(t.x,t.y)},e.prototype.setWorldPos=function(t){var e=this.node.parent.convertToNodeSpaceAR(t),o=cc.v2(e.x,e.y);this.node.position=o},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){},e.prototype.lateUpdate=function(){},e.prototype.onDestroy=function(){},e.prototype.onEnable=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){r.default.eventListener.fire("DRAG_START",t.node.name)},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.setWorldPos(e.getLocation()),r.default.eventListener.fire("DRAG_MOVE",t.node.name)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){r.default.eventListener.fire("DRAG_END",t.node.name)},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){},this)},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START),this.node.off(cc.Node.EventType.TOUCH_MOVE),this.node.off(cc.Node.EventType.TOUCH_END),this.node.off(cc.Node.EventType.TOUCH_CANCEL)},e=n([s],e)}(cc.Component));o.default=p,cc._RF.pop()},{"./global":"global"}],eventlistener:[function(t,e,o){"use strict";cc._RF.push(e,"1f05fMQieFIf4//LnIddjeI","eventlistener"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){this.es={}}return t.prototype.on=function(t,e,o){void 0===o&&(o=!1),this.es[t]||(this.es[t]=[]),this.es[t].push({cb:e,once:o})},t.prototype.once=function(t,e){this.on(t,e,!0)},t.prototype.fire=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];for(var i=this.es[t]||[],n=i.length,r=0;r<n;r++){var c=i[r],s=c.cb,p=c.once;s.apply(this,e),p&&(i.splice(r,1),r--,n--)}},t.prototype.off=function(t,e){if(void 0===t)this.es={};else if(void 0===e)delete this.es[t];else for(var o=this.es[t]||[],i=o.length,n=0;n<i;n++)o[n].cb===e&&(o.splice(n,1),n--,i--)},t.prototype.emit=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];this.fire.apply(this,[t].concat(e))},t}();o.default=i,cc._RF.pop()},{}],global:[function(t,e,o){"use strict";cc._RF.push(e,"92eb2MSw+FJvq0Mq7Ff+ehi","global"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=t("./eventlistener");(function(t){t[t.FREE=0]="FREE",t[t.ALIGNED=1]="ALIGNED",t[t.MIRRORED=2]="MIRRORED",t[t.CLOSE=3]="CLOSE"})(i=o.ControlMode||(o.ControlMode={}));var r=function(){function t(){}return t.getInstance=function(){return t.instance_},Object.defineProperty(t,"eventListener",{get:function(){return this.eventListenter_},set:function(t){this.eventListenter_=t},enumerable:!0,configurable:!0}),t.instance_=new t,t.eventListenter_=new n.default,t.controlMode=i.FREE,t}();o.default=r,cc._RF.pop()},{"./eventlistener":"eventlistener"}],pointmgr:[function(t,e,o){"use strict";cc._RF.push(e,"066c0eVF+ZC3JBQeHD9Y+tp","pointmgr");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,c=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,o,c):n(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefab=null,e.size=5,e.pool_=null,e}return i(e,t),Object.defineProperty(e.prototype,"pool",{get:function(){return this.pool_},set:function(t){this.pool_=t},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){if(this.size<1)throw Error("size < 1");if(null==this.prefab)throw Error("prefab null");for(var t=new cc.NodePool,e=0;e<this.size;e++)t.put(cc.instantiate(this.prefab));this.pool=t},e.prototype.createPoint=function(){return this.pool.size()>0?this.pool.get():cc.instantiate(this.prefab)},e.prototype.deletePoint=function(t){this.pool.put(t)},e.prototype.clearPool=function(){this.pool.clear()},n([s(cc.Prefab)],e.prototype,"prefab",void 0),n([s],e.prototype,"size",void 0),e=n([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],test:[function(t,e,o){"use strict";cc._RF.push(e,"f9fe0vwM/dDoILCxcdJqPp6","test");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,c=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,o,c):n(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./basedraw"),c=t("./pointmgr"),s=t("./beziernode"),p=t("./global"),a=cc._decorator,l=a.ccclass,u=a.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frame=null,e.pointMgr=null,e.bezierNodeList=new Array,e.time=0,e.playTime=20,e.isPlay=!1,e.totalLength=0,e.lineLengthList=new Array,e}return i(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.pointMgr=cc.find("Canvas/PointMgr").getComponent(c.default),p.default.eventListener.on("ADD_SPLINE",function(){e.isPlay=!1,e.addBezierNode()}),p.default.eventListener.on("DELETE_SPLINE",function(){e.isPlay=!1,e.removeBezierNode()}),p.default.eventListener.on("DELETE_ALL_SPLINE",function(){for(e.isPlay=!1;e.bezierNodeList.length>0;)e.removeBezierNode()}),p.default.eventListener.on("EDITOR_SCALE_SMALL",function(){var t=e.node.scale;e.node.scale=.5*t,e.frame.scale=.5*t}),p.default.eventListener.on("EDITOR_SCALE_BIG",function(){var t=e.node.scale;e.node.scale=2*t,e.frame.scale=2*t}),p.default.eventListener.on("EDITOR_SCALE_RESTORE",function(){e.node.scale=1,e.frame.scale=1,e.node.position=cc.v2(0,0),e.frame.position=cc.v2(0,0)}),p.default.eventListener.on("ARROW_L",function(){var t=e.node.position;e.node.position=t.add(cc.v2(-1,0)),e.frame.position=t.add(cc.v2(-1,0))}),p.default.eventListener.on("ARROW_U",function(){var t=e.node.position;e.node.position=t.add(cc.v2(0,1)),e.frame.position=t.add(cc.v2(0,1))}),p.default.eventListener.on("ARROW_R",function(){var t=e.node.position;e.node.position=t.add(cc.v2(1,0)),e.frame.position=t.add(cc.v2(1,0))}),p.default.eventListener.on("ARROW_D",function(){var t=e.node.position;e.node.position=t.add(cc.v2(0,-1)),e.frame.position=t.add(cc.v2(0,-1))}),p.default.eventListener.on("PLAY",function(){if(0!=e.bezierNodeList.length){e.isPlay=!0,e.totalLength=0,e.lineLengthList.splice(0,e.lineLengthList.length);for(var t=0;t<e.bezierNodeList.length;t++){var o=e.bezierNodeList[t].getLength(1);e.totalLength+=o,e.lineLengthList[t]=o}e.time=0}}),p.default.eventListener.on("STOP",function(){e.isPlay=!1}),p.default.eventListener.on("CONTROL_MODE_CHANGE",function(){e.isPlay=!1;var t=e.bezierNodeList.length;if(t>0){var o=e.bezierNodeList[0],i=e.bezierNodeList[t-1];if(p.default.controlMode==p.ControlMode.CLOSE)e.pointMgr.deletePoint(i.p3),i.p3=o.p0;else if(i.p3.name==o.p0.name){var n=e.pointMgr.createPoint(),r=3*t;n.name="Node"+r,n.position=o.p0.position,e.node.addChild(n),i.p3=n}}}),p.default.eventListener.on("DRAG_START",function(t){cc.log("-----------DRAG_START-----------");var o=Number(t.substring(4)),i=e.bezierNodeList.length;if(0==o)cc.log(0);else if(o>0&&o%3==0){var n=o/3-1,r=o/3;i==r?cc.log(n):(cc.log(n),cc.log(r))}else if(o>0&&o%3!=0){var c=Math.floor(o/3);cc.log(c)}}),p.default.eventListener.on("DRAG_MOVE",function(t){e.isPlay=!1;var o=Number(t.substring(4)),i=e.bezierNodeList.length;if(0==o)cc.log(0);else if(o>0&&o%3==0){var n=o/3-1,r=o/3;i==r?cc.log(n):(cc.log(n),cc.log(r))}else if(o>0&&o%3!=0){var c=Math.floor(o/3),s=o%3;if(cc.log(c),i>1&&o>1&&o<3*i-1){var a=e.bezierNodeList[c],l=null,u=null,f=null;if(1==s)l=e.bezierNodeList[c-1].p2,u=a.p0,f=a.p1;else if(2==s){l=e.bezierNodeList[c+1].p1,u=a.p3,f=a.p2}if(l&&u){var h=f.position.sub(u.position);if(p.default.controlMode==p.ControlMode.ALIGNED){var d=l.position.sub(u.position).mag();l.position=u.position.add(h.neg().normalize().mul(d))}else p.default.controlMode==p.ControlMode.MIRRORED&&(l.position=u.position.add(h.neg()))}}}}),p.default.eventListener.on("DRAG_END",function(t){var o=Number(t.substring(4)),i=e.bezierNodeList.length;if(0==o)cc.log(0);else if(o>0&&o%3==0){var n=o/3-1,r=o/3;i==r?cc.log(n):(cc.log(n),cc.log(r))}else if(o>0&&o%3!=0){var c=Math.floor(o/3);cc.log(c)}})},e.prototype.addBezierNode=function(){var t=this.bezierNodeList.length;if(0==t){var e=this.pointMgr.createPoint(),o=this.pointMgr.createPoint(),i=this.pointMgr.createPoint(),n=e;e.name="Node0",o.name="Node1",i.name="Node2",e.position=cc.v2(-640,0),o.position=cc.v2(-500,140),i.position=cc.v2(-500,-140),this.node.addChild(e),this.node.addChild(o),this.node.addChild(i),p.default.controlMode!=p.ControlMode.CLOSE&&((n=this.pointMgr.createPoint()).name="Node3",n.position=cc.v2(-360,0),this.node.addChild(n)),(u=new s.default(e,o,i,n)).index=0,this.bezierNodeList.push(u)}else{var r=this.bezierNodeList[t-1],c=r.p3,a=this.pointMgr.createPoint(),l=(e=c,o=this.pointMgr.createPoint(),i=this.pointMgr.createPoint(),n=a,3*t);o.name="Node"+(l+1),i.name="Node"+(l+2),n.name="Node"+(l+3);var u,f=c.position.x,h=c.position.y;o.position=cc.v2(f+140,h+140),i.position=cc.v2(f+140,h-140),n.position=cc.v2(f+280,h),p.default.controlMode==p.ControlMode.CLOSE?(n=c,(e=a).name="Node"+l,n.name=c.name,e.position=c.position,n.position=c.position,this.node.addChild(e),this.node.addChild(o),this.node.addChild(i),r.p3=e):(this.node.addChild(o),this.node.addChild(i),this.node.addChild(n)),(u=new s.default(e,o,i,n)).index=t,this.bezierNodeList.push(u)}},e.prototype.removeBezierNode=function(){var t=this.bezierNodeList.length;if(t>1){var e=this.bezierNodeList[t-2],o=this.bezierNodeList[t-1];this.pointMgr.deletePoint(o.p1),this.pointMgr.deletePoint(o.p2),p.default.controlMode==p.ControlMode.CLOSE?(this.pointMgr.deletePoint(e.p3),e.p3=o.p3):this.pointMgr.deletePoint(o.p3),this.bezierNodeList.pop()}else if(1==t){o=this.bezierNodeList[t-1];this.pointMgr.deletePoint(o.p0),this.pointMgr.deletePoint(o.p1),this.pointMgr.deletePoint(o.p2),p.default.controlMode!=p.ControlMode.CLOSE&&this.pointMgr.deletePoint(o.p3),this.bezierNodeList.pop()}},e.prototype.update=function(t){for(var e in this.clearDraw(),this.bezierNodeList)if(this.bezierNodeList.hasOwnProperty(e)){var o=this.bezierNodeList[e];o.updatePosition(t),this.setStrokeColor(cc.Color.BLUE),this.setLineWidth(2),this.drawBezierCurve(o.p0p,o.p1p,o.p2p,o.p3p),this.drawLine(o.p0p,o.p1p,cc.Color.GREEN,2),this.drawLine(o.p2p,o.p3p,cc.Color.GREEN,2)}1==this.isPlay&&(this.time+=t,this.updatePoint())},e.prototype.updatePoint=function(){if(this.time<this.playTime){for(var t=this.totalLength,e=this.time/this.playTime,o=t*e,i=this.bezierNodeList.length,n=0,r=0;r<i;r++)if((o-=this.lineLengthList[r])<0){n=r;break}e=(o+=this.lineLengthList[n])/this.lineLengthList[n];var c=this.bezierNodeList[n].cubicBezier.invert(e,o),s=this.bezierNodeList[n].cubicBezier.getPoint(c);cc.color(Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random()));this.drawCirclePoint(s,cc.Color.RED,3,!0)}else this.time=0},n([u(cc.Node)],e.prototype,"frame",void 0),e=n([l],e)}(r.default);o.default=f,cc._RF.pop()},{"./basedraw":"basedraw","./beziernode":"beziernode","./global":"global","./pointmgr":"pointmgr"}],ui:[function(t,e,o){"use strict";cc._RF.push(e,"4d0e5+IXqtAZ7+iLHHNV/Rg","ui");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,c=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(r<3?n(c):r>3?n(e,o,c):n(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./global"),c=t("./drag"),s=cc._decorator,p=s.ccclass,a=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.input=null,e}return i(e,t),e.prototype.onLoad=function(){this.setReferenceDraggable(!1),this.createFileLoader()},e.prototype.createFileLoader=function(){var t=this;if(cc.sys.isBrowser)if(window.File&&window.FileReader&&window.FileList&&window.Blob){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.setAttribute("style","position:absolute;margin-left:0%;margin-top:0px;-webkit-user-select:file;display:none"),document.getElementsByTagName("body")[0].appendChild(e);e.addEventListener("change",function(e){var o=e.target.files[0];if(!o.type.match("image.*"))return!1;var i=new FileReader;i.readAsDataURL(o),i.onload=function(e){var o=document.createElement("img");o.src=e.target.result;var i=new cc.Texture2D;i._nativeAsset=o,i.on("load",function(){t.sprite.spriteFrame=new cc.SpriteFrame(i)})}}),this.input=e}else alert("\u4e0d\u652f\u6301")},e.prototype.onClickUp=function(){this.node.position=cc.v2(0,40)},e.prototype.onClickDown=function(){this.node.position=cc.v2(0,-720)},e.prototype.onClickAddSpline=function(){r.default.eventListener.fire("ADD_SPLINE")},e.prototype.onClickDeleteSpline=function(){r.default.eventListener.fire("DELETE_SPLINE")},e.prototype.onClickDeleteAllSpline=function(){r.default.eventListener.fire("DELETE_ALL_SPLINE")},e.prototype.onClickScaleSmall=function(){r.default.eventListener.fire("EDITOR_SCALE_SMALL")},e.prototype.onClickScaleBig=function(){r.default.eventListener.fire("EDITOR_SCALE_BIG")},e.prototype.onClickScaleRestore=function(){r.default.eventListener.fire("EDITOR_SCALE_RESTORE")},e.prototype.onClickArrowL=function(){r.default.eventListener.fire("ARROW_L")},e.prototype.onClickArrowU=function(){r.default.eventListener.fire("ARROW_U")},e.prototype.onClickArrowR=function(){r.default.eventListener.fire("ARROW_R")},e.prototype.onClickArrowD=function(){r.default.eventListener.fire("ARROW_D")},e.prototype.onClickPlay=function(){r.default.eventListener.fire("PLAY")},e.prototype.onClickStop=function(){r.default.eventListener.fire("STOP")},e.prototype.onCheckEdit=function(t,e){cc.log(t.isChecked),r.default.eventListener.fire("CHECK_EDIT")},e.prototype.onFileLoader=function(){this.input&&this.input.click()},e.prototype.onCheckReferenceEdit=function(t,e){this.setReferenceDraggable(t.isChecked)},e.prototype.setReferenceDraggable=function(t){this.sprite&&(this.sprite.getComponent(c.default).enabled=t)},e.prototype.onControlMode=function(t,e){t.isChecked;var o=t.name.substring(0,7);"toggle1"==o?r.default.controlMode=r.ControlMode.FREE:"toggle2"==o?r.default.controlMode=r.ControlMode.ALIGNED:"toggle3"==o?r.default.controlMode=r.ControlMode.MIRRORED:"toggle4"==o&&(r.default.controlMode=r.ControlMode.CLOSE),cc.log(r.default.controlMode),r.default.eventListener.fire("CONTROL_MODE_CHANGE")},n([a(cc.Sprite)],e.prototype,"sprite",void 0),e=n([p],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./drag":"drag","./global":"global"}]},{},["NewScript","basedraw","beziernode","cubicbezier","drag","eventlistener","global","pointmgr","test","ui"]);